"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(globalThis["webpackChunk"] = globalThis["webpackChunk"] || []).push([["src_common_common_ts"],{

/***/ "./src/common/common.ts":
/*!******************************!*\
  !*** ./src/common/common.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var bootstrap_js_dist_collapse__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! bootstrap/js/dist/collapse */ \"../node_modules/bootstrap/js/dist/collapse.js\");\n/* harmony import */ var bootstrap_js_dist_collapse__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(bootstrap_js_dist_collapse__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jquery */ \"../node_modules/jquery/dist/jquery.js\");\n/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_shoppingCart__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../lib/shoppingCart */ \"./src/lib/shoppingCart.ts\");\n/* harmony import */ var aos__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! aos */ \"../node_modules/aos/dist/aos.js\");\n/* harmony import */ var aos__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(aos__WEBPACK_IMPORTED_MODULE_3__);\n\n// import Alert from 'bootstrap/js/dist/alert';\n// import Button from 'bootstrap/js/dist/button';\n// import Carousel from 'bootstrap/js/dist/carousel';\n\n// import 'bootstrap/js/dist/dropdown';\n// import Modal from 'bootstrap/js/dist/modal';\n// import Offcanvas from 'bootstrap/js/dist/offcanvas';\n// import Popover from 'bootstrap/js/dist/popover';\n// import ScrollSpy from 'bootstrap/js/dist/scrollspy';\n// import Tab from 'bootstrap/js/dist/tab';\n// import Toast from 'bootstrap/js/dist/toast';\n// import Tooltip from 'bootstrap/js/dist/tooltip';\n\nwindow.$ = window.jquery = (jquery__WEBPACK_IMPORTED_MODULE_1___default());\n\n\n\nfunction aos_init() {\n  aos__WEBPACK_IMPORTED_MODULE_3___default().init({\n    duration: 1000,\n    easing: \"ease-in-out\",\n    once: true,\n    mirror: false\n  });\n}\nwindow.addEventListener('load', () => {\n  aos_init();\n});\n\n//# sourceURL=webpack:///./src/common/common.ts?");

/***/ }),

/***/ "./src/lib/shoppingCart.ts":
/*!*********************************!*\
  !*** ./src/lib/shoppingCart.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jquery */ \"../node_modules/jquery/dist/jquery.js\");\n/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! notiflix/build/notiflix-notify-aio */ \"../node_modules/notiflix/build/notiflix-notify-aio.js\");\n/* harmony import */ var notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var notiflix_build_notiflix_loading_aio__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! notiflix/build/notiflix-loading-aio */ \"../node_modules/notiflix/build/notiflix-loading-aio.js\");\n/* harmony import */ var notiflix_build_notiflix_loading_aio__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(notiflix_build_notiflix_loading_aio__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\n\nconst form = document.getElementById(\"payment-form\");\nlet Snipcart = window.Snipcart;\njquery__WEBPACK_IMPORTED_MODULE_0___default()(() => {\n  Snipcart = window.Snipcart;\n});\nfunction onCodeInput(event) {\n  const promoCode = event.target.value.trim();\n  if (promoCode.length != 0) {\n    localStorage.setItem(\"promoCode\", promoCode);\n  } else {\n    localStorage.removeItem(\"promoCode\");\n  }\n}\nwindow.onCodeInput = onCodeInput;\nfunction applyPromo() {\n  const theCode = localStorage.getItem(\"promoCode\");\n  const activeCart = Snipcart.store.getState().cart;\n  if (activeCart) {\n    const cartDiscounts = activeCart.discounts.items;\n    if (cartDiscounts.length != 0) {\n      notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(\"Promo Code Already Applied\");\n      return;\n    }\n    if (theCode && theCode.length != 0) {\n      addPromoToOrder(theCode);\n    }\n  }\n}\nwindow.applyPromo = applyPromo;\nasync function removePromo() {\n  const activeCart = Snipcart.store.getState().cart;\n  if (activeCart) {\n    const cartDiscounts = activeCart.discounts.items;\n    if (cartDiscounts.length != 0) {\n      const theDiscount = cartDiscounts[0];\n      const couponCode = theDiscount.code;\n      removePromoFromOrder(couponCode);\n    } else {\n      notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(\"No Any Promo Code Applied Yet\");\n    }\n  }\n}\nwindow.removePromo = removePromo;\ndocument.addEventListener(\"snipcart.ready\", async () => {\n  let currentValue;\n  const Snipcart = window.Snipcart;\n  Snipcart.store.subscribe(() => {\n    let previousValue = currentValue;\n    currentValue = Snipcart.store.getState();\n    const isAddressPage = window.location.hash?.includes(\"checkout\");\n    const isSideBar = document.querySelector(\".snipcart-layout__content--side\");\n    if (isAddressPage && !isSideBar && previousValue !== currentValue) {\n      if (currentValue.cart.items.count != 0) {\n        setOrderCoreDetails(currentValue.cart);\n      }\n    }\n  });\n  Snipcart.events.on(\"item.added\", cartItem => {\n    addToCart(cartItem.name, cartItem.quantity);\n  });\n  Snipcart.events.on(\"item.updated\", cartItem => {\n    getActiveOrder().then(data => {\n      const theLine = data.find(line => line.productVariant.name == cartItem.name);\n      if (theLine) {\n        const lineID = theLine.id;\n        updateCart(lineID, cartItem.quantity);\n      } else {\n        notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(\"Some issue with the order. Retry on contact store owner.\");\n      }\n    }).catch(err => {\n      notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(err);\n    });\n  });\n  Snipcart.events.on(\"item.removed\", cartItem => {\n    getActiveOrder().then(data => {\n      const theLine = data.find(line => line.productVariant.name == cartItem.name);\n      if (theLine) {\n        const lineID = theLine.id;\n        removeCartProduct(lineID);\n      } else {\n        notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(\"Some issue with the order. Retry on contact store owner.\");\n      }\n    });\n  });\n  Snipcart.events.on(\"shipping.selected\", shippingMethod => {\n    const methodsBreak = shippingMethod.method.split(\"(\");\n    if (methodsBreak) {\n      const serviceName = methodsBreak[0].trim();\n      const serviceCode = methodsBreak[1].replaceAll(\")\", \"\").trim().split(\"[\")[0].trim();\n      const carrierBreak = shippingMethod.method.split(\"[\");\n      const carrierCode = carrierBreak[1].replaceAll(\"]\", \"\").trim();\n      const shippingCost = Number(Number(shippingMethod.cost).toFixed(2)) * 100;\n      const shippingObject = {\n        serviceCode,\n        serviceName,\n        carrierCode,\n        shippingCost\n      };\n      localStorage.setItem(\"shippingObject\", JSON.stringify(shippingObject));\n      setCartShippingCustomThings();\n    }\n  });\n});\nfunction removePromoFromOrder(discountCode) {\n  const removePromoQuery = `mutation RemoveCouponCode($code: String!) {\n          removeCouponCode(couponCode: $code) {\n              id\n          }\n        }\n        `;\n  jquery__WEBPACK_IMPORTED_MODULE_0___default().ajax({\n    method: \"POST\",\n    url: window.backend_url,\n    contentType: \"application/json\",\n    xhrFields: {\n      withCredentials: true\n    },\n    crossDomain: true,\n    data: JSON.stringify({\n      query: removePromoQuery,\n      variables: {\n        code: discountCode\n      }\n    }),\n    success: function (data) {\n      if (!data.data) {\n        notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(data.errors[0].message);\n      } else {\n        try {\n          if (!data.data.removeCouponCode.id) {\n            notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(\"Some issue with the order. Retry again or contact store owner.\");\n            return;\n          }\n          Snipcart.api.cart.removeDiscount(discountCode);\n          notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.success(\"Promo Code Removed\");\n        } catch (err) {\n          notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(err?.message || err);\n        }\n      }\n    }\n  });\n}\nfunction addPromoToOrder(discountCode) {\n  const addPromoQuery = `mutation ApplyCouponCode($code: String!) {\n          applyCouponCode(couponCode: $code){\n            ...on Order{\n              id\n            }\n            ...on ErrorResult{\n              errorCode\n              message\n            }\n          }\n        }\n        `;\n  jquery__WEBPACK_IMPORTED_MODULE_0___default().ajax({\n    method: \"POST\",\n    url: window.backend_url,\n    contentType: \"application/json\",\n    xhrFields: {\n      withCredentials: true\n    },\n    crossDomain: true,\n    data: JSON.stringify({\n      query: addPromoQuery,\n      variables: {\n        code: discountCode\n      }\n    }),\n    success: function (data) {\n      if (!data.data) {\n        notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(data.errors[0].message);\n      } else {\n        if (data.data.applyCouponCode.errorCode) {\n          notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(data.data.applyCouponCode.message);\n          return;\n        }\n        try {\n          Snipcart.api.cart.applyDiscount(discountCode);\n          notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.success(\"Promo Code Applied\");\n        } catch (err) {\n          notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(err?.message || err);\n        }\n      }\n    }\n  });\n}\nfunction setOrderCoreDetails(cart) {\n  if (cart?.token) {\n    setCartCustomThings(cart);\n  }\n  if (cart?.billingAddress?.address1) {\n    const billingAddressInput = {\n      fullName: cart.billingAddress.fullName,\n      streetLine1: cart.billingAddress.address1,\n      streetLine2: cart.billingAddress.address2,\n      city: cart.billingAddress.city,\n      province: cart.billingAddress.province,\n      postalCode: cart.billingAddress.postalCode,\n      countryCode: cart.billingAddress.country,\n      phoneNumber: cart.billingAddress.phone,\n      customFields: {\n        email: cart?.email\n      }\n    };\n    setCartBillingAddress(billingAddressInput);\n  }\n  if (cart?.shippingAddress?.address1) {\n    const shippingAddressInput = {\n      fullName: cart.shippingAddress.fullName,\n      streetLine1: cart.shippingAddress.address1,\n      streetLine2: cart.shippingAddress.address2,\n      city: cart.shippingAddress.city,\n      province: cart.shippingAddress.province,\n      postalCode: cart.shippingAddress.postalCode,\n      countryCode: cart.shippingAddress.country,\n      phoneNumber: cart.shippingAddress.phone,\n      customFields: {\n        email: cart?.email\n      }\n    };\n    setCartShippingAddress(shippingAddressInput);\n    setCartShippingCustomThings();\n  }\n}\nfunction processPayment(opaqueData) {\n  transitionOrderToState(\"ArrangingPayment\", true).then(orderData => {\n    if (orderData == \"already\") {\n      addRealPayment(opaqueData);\n      return;\n    }\n    if (orderData?.transitionOrderToState?.id) {\n      addRealPayment(opaqueData);\n    } else {\n      notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(\"Some issue with the order. Retry on contact store owner.\");\n    }\n  }).catch(err => {\n    console.log(err);\n    notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(err);\n  });\n}\nfunction addRealPayment(opaqueData) {\n  notiflix_build_notiflix_loading_aio__WEBPACK_IMPORTED_MODULE_2__.Loading.standard(\"Processing Payment...\");\n  const addPaymentQuery = `\n    mutation AddGuestPaymentToOrder($input: PaymentInput!) {\n      addGuestPaymentToOrder(input: $input){\n          ...on Order{\n              id\n          }\n        ...on ErrorResult{\n            errorCode\n            message\n        }\n      }\n    }\n  `;\n  jquery__WEBPACK_IMPORTED_MODULE_0___default().ajax({\n    method: \"POST\",\n    url: window.backend_url,\n    contentType: \"application/json\",\n    xhrFields: {\n      withCredentials: true\n    },\n    crossDomain: true,\n    data: JSON.stringify({\n      query: addPaymentQuery,\n      variables: {\n        input: {\n          method: \"authorize\",\n          metadata: {\n            dataDescriptor: opaqueData.dataDescriptor,\n            dataValue: opaqueData.dataValue\n          }\n        }\n      }\n    }),\n    success: function (data) {\n      if (!data.data) {\n        const errMsg = data.errors.at(0).message;\n        notiflix_build_notiflix_loading_aio__WEBPACK_IMPORTED_MODULE_2__.Loading.remove();\n        notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(errMsg);\n        return;\n      } else {\n        if (data.data?.addGuestPaymentToOrder?.errorCode) {\n          notiflix_build_notiflix_loading_aio__WEBPACK_IMPORTED_MODULE_2__.Loading.remove();\n          notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(data.data.addGuestPaymentToOrder.message);\n          return;\n        }\n        notiflix_build_notiflix_loading_aio__WEBPACK_IMPORTED_MODULE_2__.Loading.remove();\n        notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.success(\"Order successfully processed.\");\n        jquery__WEBPACK_IMPORTED_MODULE_0___default()(\".cupon-pop\").empty();\n        jquery__WEBPACK_IMPORTED_MODULE_0___default()(\".cupon-pop\").append(\"Your Order ID: <span>\" + window.localStorage.getItem(\"orderCode\") + \"</span>\");\n        jquery__WEBPACK_IMPORTED_MODULE_0___default()(\"#successModal\").modal(\"show\");\n        const itemsID = Snipcart.store.getState().cart.items.items.map(item => item.uniqueId);\n        if (itemsID.length != 0) {\n          for (const itemID of itemsID) {\n            Snipcart.api.cart.items.remove(itemID);\n          }\n        }\n      }\n    }\n  });\n}\nfunction getStripeClientSecret() {\n  return new Promise((resolve, reject) => {\n    const clientSecretQuery = `mutation CreateStripePaymentIntent{\n          createStripePaymentIntent\n        }\n        `;\n    jquery__WEBPACK_IMPORTED_MODULE_0___default().ajax({\n      method: \"POST\",\n      url: window.backend_url,\n      contentType: \"application/json\",\n      xhrFields: {\n        withCredentials: true\n      },\n      crossDomain: true,\n      data: JSON.stringify({\n        query: clientSecretQuery\n      }),\n      success: function (data) {\n        if (!data.data) {\n          reject(data.errors.at(0).message);\n        } else {\n          resolve(data.data);\n        }\n      }\n    });\n  });\n}\nfunction transitionOrderToState(state, isArrangingPayment = false) {\n  return new Promise((resolve, reject) => {\n    getActiveOrder(true).then(data => {\n      if (isArrangingPayment && data.state == \"ArrangingPayment\") {\n        return resolve(\"already\");\n      }\n      const transitionOrderQuery = `mutation TransitionOrderToState($state: String!){\n          transitionOrderToState(state: $state){\n                ...on Order{\n                  id\n                  code\n                  billingAddress {\n                    fullName\n                  }\n                }\n                ...on ErrorResult{\n                  errorCode\n                  message\n                }\n              }\n            }\n            `;\n      jquery__WEBPACK_IMPORTED_MODULE_0___default().ajax({\n        method: \"POST\",\n        url: window.backend_url,\n        contentType: \"application/json\",\n        xhrFields: {\n          withCredentials: true\n        },\n        crossDomain: true,\n        data: JSON.stringify({\n          query: transitionOrderQuery,\n          variables: {\n            state: state\n          }\n        }),\n        success: function (data) {\n          if (!data.data) {\n            reject(data.errors.at(0).message);\n          } else {\n            resolve(data.data);\n          }\n        }\n      });\n    }).catch(err => {\n      reject(err);\n    });\n  });\n}\nfunction setCartCustomThings(cart) {\n  getActiveOrder().then(data => {\n    if (data) {\n      const setCartTokenQuery = `mutation SetOrderCustomField($input: UpdateOrderInput!){\n              setOrderCustomFields(input: $input){\n                ...on Order{\n                  id\n                }\n                ...on ErrorResult{\n                  errorCode\n                  message\n                }\n              }\n            }\n            `;\n      jquery__WEBPACK_IMPORTED_MODULE_0___default().ajax({\n        method: \"POST\",\n        url: window.backend_url,\n        contentType: \"application/json\",\n        xhrFields: {\n          withCredentials: true\n        },\n        crossDomain: true,\n        data: JSON.stringify({\n          query: setCartTokenQuery,\n          variables: {\n            input: {\n              customFields: {\n                snipCartToken: cart.token\n              }\n            }\n          }\n        }),\n        success: function (data) {\n          if (!data.data) {\n            notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(data.errors.at(0).message);\n          }\n        }\n      });\n    }\n  }).catch(err => {\n    notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(err?.message || err);\n  });\n}\nfunction setCartShippingCustomThings() {\n  getActiveOrder().then(data => {\n    if (data) {\n      const setCartCustomThingsQuery = `mutation SetOrderCustomField($input: UpdateOrderInput!){\n              setOrderCustomFields(input: $input){\n                ...on Order{\n                  id\n                  customFields {\n                    carrierCode\n                    serviceCode\n                    serviceName\n                    shippingCost\n                  }\n                }\n                ...on ErrorResult{\n                  errorCode\n                  message\n                }\n              }\n            }\n            `;\n      const shippingObjectStored = localStorage.getItem(\"shippingObject\");\n      console.log(shippingObjectStored);\n      if (shippingObjectStored) {\n        const shippingObject = JSON.parse(shippingObjectStored);\n        jquery__WEBPACK_IMPORTED_MODULE_0___default().ajax({\n          method: \"POST\",\n          url: window.backend_url,\n          contentType: \"application/json\",\n          xhrFields: {\n            withCredentials: true\n          },\n          crossDomain: true,\n          data: JSON.stringify({\n            query: setCartCustomThingsQuery,\n            variables: {\n              input: {\n                customFields: {\n                  carrierCode: shippingObject.carrierCode,\n                  serviceCode: shippingObject.serviceCode,\n                  serviceName: shippingObject.serviceName,\n                  shippingCost: shippingObject.shippingCost\n                }\n              }\n            }\n          }),\n          success: function (data) {\n            if (!data.data) {\n              notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(data.errors.at(0).message);\n            }\n          }\n        });\n      }\n    }\n  }).catch(err => {\n    if (!err.includes(\"insert\")) notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(err);\n  });\n}\nfunction setCartBillingAddress(addressInput) {\n  getActiveOrder().then(data => {\n    if (data) {\n      const setCartBillingAddressQuery = `mutation SetOrderBillingAddress($input: CreateAddressInput!){\n              setOrderBillingAddress(input: $input){\n                ...on Order{\n                  id\n                }\n                ...on ErrorResult{\n                  errorCode\n                  message\n                }\n              }\n            }\n            `;\n      jquery__WEBPACK_IMPORTED_MODULE_0___default().ajax({\n        method: \"POST\",\n        url: window.backend_url,\n        contentType: \"application/json\",\n        xhrFields: {\n          withCredentials: true\n        },\n        crossDomain: true,\n        data: JSON.stringify({\n          query: setCartBillingAddressQuery,\n          variables: {\n            input: addressInput\n          }\n        }),\n        success: function (data) {\n          if (!data.data) {\n            notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(data.errors.at(0).message);\n          }\n        }\n      });\n    }\n  }).catch(err => {\n    notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(err);\n  });\n}\nfunction setCartShippingAddress(addressInput) {\n  getActiveOrder().then(data => {\n    if (data) {\n      const setCartShippingAddressQuery = `mutation SetOrderShippingAddress($input: CreateAddressInput!){\n              setOrderShippingAddress(input: $input){\n                ...on Order{\n                  id\n                }\n                ...on ErrorResult{\n                  errorCode\n                  message\n                }\n              }\n            }\n            `;\n      jquery__WEBPACK_IMPORTED_MODULE_0___default().ajax({\n        method: \"POST\",\n        url: window.backend_url,\n        contentType: \"application/json\",\n        xhrFields: {\n          withCredentials: true\n        },\n        crossDomain: true,\n        data: JSON.stringify({\n          query: setCartShippingAddressQuery,\n          variables: {\n            input: addressInput\n          }\n        }),\n        success: function (data) {\n          if (!data.data) {\n            notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(data.errors.at(0).message);\n          }\n        }\n      });\n    }\n  }).catch(err => {\n    notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(err);\n  });\n}\nfunction getActiveOrder(onlyOrder = false) {\n  const activeOrderQuery = `query ActiveOrder{\n        activeOrder{\n          id\n          code\n          state\n          lines{\n            id\n            productVariant {\n              id\n              name\n            }\n          }\n        }\n      }`;\n  return new Promise((resolve, reject) => {\n    jquery__WEBPACK_IMPORTED_MODULE_0___default().ajax({\n      method: \"POST\",\n      url: window.backend_url,\n      contentType: \"application/json\",\n      xhrFields: {\n        withCredentials: true\n      },\n      crossDomain: true,\n      data: JSON.stringify({\n        query: activeOrderQuery\n      }),\n      success: function (data) {\n        if (data.data) {\n          if (data.data.activeOrder?.code) {\n            window.localStorage.setItem(\"orderCode\", data.data.activeOrder.code);\n          }\n          if (onlyOrder) {\n            resolve(data.data.activeOrder);\n          }\n          resolve(data.data.activeOrder?.lines);\n        }\n      }\n    });\n  });\n}\nfunction getPaymentKeys() {\n  const paymentKeysQuery = `query AuthorizeNetKeys {\n      authorizeNetKeys {\n        apiLoginId\n        publicKeyClient\n      }\n    }`;\n  return new Promise((resolve, reject) => {\n    jquery__WEBPACK_IMPORTED_MODULE_0___default().ajax({\n      method: \"POST\",\n      url: window.backend_url,\n      contentType: \"application/json\",\n      xhrFields: {\n        withCredentials: true\n      },\n      crossDomain: true,\n      data: JSON.stringify({\n        query: paymentKeysQuery\n      }),\n      success: function (data) {\n        if (data.data && data.data.authorizeNetKeys) {\n          resolve(data.data.authorizeNetKeys);\n        } else {\n          reject(\"Payment Keys error\");\n        }\n      },\n      error: function (err) {\n        reject(\"Payment Keys error\");\n      }\n    });\n  });\n}\nfunction updateCart(lineID, quantity) {\n  const adjustItemQuery = `mutation AdjustOrderLine($id: ID!, $qty: Int!){\n        adjustOrderLine(orderLineId: $id, quantity: $qty){\n          ...on Order{\n            id\n          }\n          ...on ErrorResult{\n            errorCode\n            message\n          }\n        }\n      }\n      `;\n  jquery__WEBPACK_IMPORTED_MODULE_0___default().ajax({\n    method: \"POST\",\n    url: window.backend_url,\n    contentType: \"application/json\",\n    xhrFields: {\n      withCredentials: true\n    },\n    crossDomain: true,\n    data: JSON.stringify({\n      query: adjustItemQuery,\n      variables: {\n        id: lineID,\n        qty: quantity\n      }\n    }),\n    success: function (data) {\n      if (data.data) {\n        notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.success(\"Successfully adjusted order\");\n      } else {\n        notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(data.errors.at(0).message);\n      }\n    }\n  });\n}\nfunction removeCartProduct(lineID, quantity) {\n  const adjustItemQuery = `mutation RemoveOrderLine($id: ID!){\n        removeOrderLine(orderLineId: $id){\n          ...on Order{\n            id\n          }\n          ...on ErrorResult{\n            errorCode\n            message\n          }\n        }\n      }\n      `;\n  jquery__WEBPACK_IMPORTED_MODULE_0___default().ajax({\n    method: \"POST\",\n    url: window.backend_url,\n    contentType: \"application/json\",\n    xhrFields: {\n      withCredentials: true\n    },\n    crossDomain: true,\n    data: JSON.stringify({\n      query: adjustItemQuery,\n      variables: {\n        id: lineID\n      }\n    }),\n    success: function (data) {\n      if (!data.data) {\n        notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(data.errors.at(0).message);\n      }\n    }\n  });\n}\nfunction addToCart(variantName, quantity) {\n  const getPVId = `query ProductVariantByName($name: String!){\n        productVariantByName(name:$name){\n          id\n         }\n        }\n      `;\n  jquery__WEBPACK_IMPORTED_MODULE_0___default().ajax({\n    method: \"POST\",\n    url: window.backend_url,\n    contentType: \"application/json\",\n    data: JSON.stringify({\n      query: getPVId,\n      variables: {\n        name: variantName\n      }\n    }),\n    success: function (data) {\n      if (data.data) {\n        finallyAddToCart(data.data.productVariantByName.id, quantity);\n      } else {\n        notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(data.errors.at(0).message);\n      }\n    }\n  });\n}\nfunction finallyAddToCart(variantID, quantity) {\n  const cartMutation = `mutation addItemToOrder($productVariantId:ID!, $quantity: Int!){\n        addItemToOrder(productVariantId:$productVariantId, quantity:$quantity){\n          ...on Order{\n            id\n          }\n          ...on ErrorResult{\n            errorCode\n            message\n          }\n        }\n      }`;\n  jquery__WEBPACK_IMPORTED_MODULE_0___default().ajax({\n    method: \"POST\",\n    url: window.backend_url,\n    contentType: \"application/json\",\n    xhrFields: {\n      withCredentials: true\n    },\n    crossDomain: true,\n    data: JSON.stringify({\n      query: cartMutation,\n      variables: {\n        productVariantId: variantID,\n        quantity: quantity\n      }\n    }),\n    success: function (data) {\n      if (data.data) {\n        notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.success(\"Successfully Added To Cart\");\n      } else {\n        notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(data.errors.at(0).message);\n      }\n    }\n  });\n}\nwindow.performPayment = function performPayment() {\n  jquery__WEBPACK_IMPORTED_MODULE_0___default()(\"#acceptPaymentButton\").click();\n};\nwindow.responseHandler = function responseHandler(response) {\n  if (response.messages.resultCode === \"Error\") {\n    let i = 0;\n    let theMessage = \"\";\n    while (i < response.messages.message.length) {\n      theMessage = theMessage + response.messages.message[i].code + \": \" + response.messages.message[i].text + \"\\n\";\n      i = i + 1;\n    }\n    notiflix_build_notiflix_notify_aio__WEBPACK_IMPORTED_MODULE_1__.Notify.failure(theMessage);\n  } else {\n    paymentFormUpdate(response.opaqueData);\n  }\n  function paymentFormUpdate(opaqueData) {\n    processPayment(opaqueData);\n  }\n};\n\n//# sourceURL=webpack:///./src/lib/shoppingCart.ts?");

/***/ })

}]);